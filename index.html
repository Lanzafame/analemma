<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<title>Analemma</title>
<style type="text/css">

  body {font-family: Garamond, Bodoni, "Times New Roman"; background-color: #ffffff; padding: 5px; font-size: 1.1em; color: #333333; }
  h1 { font-family: Garamond, Georgia, serif; color: #000066; }
  h2 { font-family: Helvetica, Gill, sans-serif; color: #000066; }
  h3, h4 { color: #444444; }
  li {padding-left: 25px; padding-right: 25px; padding-top: 5px; }
  .code-ref { background-color: #F8F8F8; color: #003399; font-style:italic; padding-left: 5px; padding-right: 5px; font-size: 0.9em; }
  .code-sig { background-color: #DDDDDD; color: #003399; font-family: "Courier New", Courier; padding-left: 5px; }
  .code-listing { background-color: #FFFFFF; color: #444444; border: #EEEEEE 1px solid;  padding-bottom: 1px; padding-left: 5px; border-bottom: #DDDDDD 1px solid; border-right: #DDDDDD 1px solid; font-size: 1em }
  .quote { background-color: #F8F8F8; color: #555555; font-style:italic; padding-left: 25px; padding-right: 25px; width: 500px; margin: 15px; }
code { color: #555555; }
  .content { width: 675px; margin: 0px auto; }
  p { text-align: justify; }
  .box { background-color: #DDDDDD; color: #333333; padding-left:
  15px; padding-top: 15px; padding-bottom: 15px;  border: #CCCCCC 1px
  solid; border-bottom: #CCCCCC 1px solid; border-right: #CCCCCC 1px
  solid; font-size: 0.95em; font-family: Helvetica, Gill, sans-serif; }
  .box li { padding: 2px; }
  .box ul { margin-top: 5px; margin-bottom: 2px; }
  .footnote { font-style: italic; color:#777777; font-size: 0.9em; padding-left: 5px;
  padding-right: 25px; padding-bottom: 10px; }

  strike, s { text-decoration: line-through; color: red; font-weight: bold; }
  .insert { font-weight: bold; font-style: italic; color:#33a933;}
</style>
</head>

<body>
<div class="content">
  

<embed src="images/analemma-logo.svg" width="475" height="135"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />

 <p><i><b>Analemma</b> is a <a
  href="http://clojure.org">Clojure</a>-based <a href="http://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG</a> DSL and charting library.</i> In astronomy, an <a href="http://en.wikipedia.org/wiki/Analemma">analemma</a> is the figure drawn in the sky by the different positions of the Sun recorded at the same time and location during the course of a year.

<h2>Architecture</h2>
  
  <embed src="images/analemma-stack.svg" width="350" height="200"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />

<div class="footnote">* The above animated image may not be visible in
 Firefox, and has not been tested in IE.</div>
 
<h2>Example Charts</h2>

<h3>Plotting Analemma Data</h3>

<div class="code-listing">
<pre><code>(spit "analemma.svg"
      (emit-svg
        (-> (xy-plot :xmin -30 :maxx 10,
                     :ymin -30 :maxy 30
                     :height 500 :width 500)
	     (add-points analemma-data))))
</code></pre>
</div>

<p>The full source code and data for this example can
be found at <a
href="https://github.com/liebke/analemma/blob/master/src/examples/analemma.clj">
github</a>. The data was obtained from <a
href="http://www.wsanford.com/~wsanford/exo/sundials/analemma_calc.html">this
site</a>.</p>

<embed src="images/analemma.svg" width="600" height="600"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />


<h3>Plotting Sine and Cosine</h3>

<div class="code-listing">
<pre><code>(let [x (range -5 5 0.05)
      y1 (map #(Math/cos %) x)
      y2 (map #(Math/sin %) x)]
  (spit "sin-cos-small.svg"
    (emit-svg
      (-> (xy-plot :width 450 :height 200
                   :xmin -5 :xmax 5
                   :ymin -1.5 :ymax 1.5)
          (add-points [x y1]
                      :transpose-data? true
                      :size 1)
          (add-points [x y2]
                      :transpose-data? true
                      :size 1
                      :fill (rgb 255 0 0))))))
</code></pre>
</div>

<p>The full source code and data for this example can
be found at <a
href="https://github.com/liebke/analemma/blob/master/src/examples/charts.clj">
github</a>.</p>

<embed src="images/sin-cos-small.svg" width="600" height="300"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />


<h3>Plotting Random Data</h3>

<div class="code-listing">
<pre><code>
(let [x (repeatedly 25 #(rand-int 100))
      y (repeatedly 25 #(rand-int 100))]
 (spit (str directory "rand-plot.svg")
       (emit-svg
          (-> (xy-plot :width 500 :height 500
                       :label-points? true)
              (add-points [x y] :transpose-data? true)))))
</code></pre>
</div>

<p>The full source code and data for this example can
be found at <a
href="https://github.com/liebke/analemma/blob/master/src/examples/charts.clj">
github</a>.</p>

<embed src="images/rand-plot.svg" width="600" height="600"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />


<h2>SVG Examples</h2>

<h3>Analemma Logo</h3>

<embed src="images/analemma-logo.svg" width="475" height="135" 
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />

<p>The full source code and data for this example can
be found at <a
href="https://github.com/liebke/analemma/blob/master/src/examples/analemma.clj">
github</a>.</p>

<div class="code-listing">
<pre><code>(emit
  (svg
    (apply group
           (rect 0 0 160 500 :fill "#ffffff")
           (-> (text {:x 120 :y 60} "Analemma")
               (style :fill #"000066"
                      :font-family "Garamond"
                      :font-size "75px"
                      :alignment-baseline :middle))
             (for [[x y] analemma-data]
               (circle (translate-value x -30 5 0 125)
                       (translate-value y -25 30 125 0)
                       2 :fill "#000066")))))
</code></pre></div>

<h3>Animated Analemma Stack</h3>

<embed src="images/analemma-stack.svg" width="350" height="200"
type="image/svg+xml"
pluginspage="http://www.adobe.com/svg/viewer/install/" />

<div class="footnote">* The above animated image may not be visible in
 Firefox, and has not been tested in IE.</div>

<p>The full source code and data for this example can
be found at <a
href="https://github.com/liebke/analemma/blob/master/src/examples/charts.clj">
github</a>.</p>

<div class="code-listing">
 <pre><code>
(defn txt-box [txt x y fill]
  (let [box-width 300
	box-height 50]
    (svg {:x x :y y}
	 (group 
	  (-> (rect 0 0 box-height box-width :rx 5 :ry 5)
	      (style :stroke fill :fill fill))
	  (-> (text {:x (/ box-width 2)
		     :y (/ box-height 2)}
		    txt)
	      (style :fill "#ffffff"
		     :font-size "25px"
		     :font-family "Verdana"
		     :alignment-baseline :middle
		     :text-anchor :middle))))))

(defn analemma-stack [directory]
  (spit (str directory "analemma-stack.svg")
	(emit
	 (svg
	  (-> (group
	       (-> (txt-box "analemma.charts" 0 10 "#006600")
		   (add-attrs :visibility :hidden)
		   (animate :visibility :to :visible :begin 5)
		   (animate :y :begin 5 :dur 1 :from 0 :to 10))
	       (-> (txt-box "analemma.svg" 0 65 "#660000")
		   (add-attrs :visibility :hidden)
		   (animate :visibility :to :visible :begin 3)
		   (animate :y :begin 3 :dur 2 :from 0 :to 65))
	       (-> (txt-box "analemma.xml" 0 120 "#000066")
		   (add-attrs :visibility :hidden)
		   (animate :visibility :to :visible :begin 1)
		   (animate :y :begin 1 :dur 4 :from 0 :to 120)))
	      (translate 10 10))))))
  </code></pre>
</div>


</div> <!-- content -->
</body> </html>